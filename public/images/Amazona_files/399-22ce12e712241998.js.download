"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[399],{3399:function(e,n,t){t.d(n,{Z:function(){return _}});var r=t(4051),s=t.n(r),a=t(5893),c=t(1664),i=t(7294),o=t(3299),d=t(1955),l=t(782),u=(t(4213),t(3737)),h=t(5530),f=t(2173),m=t(9065),x=t(8381),p=t(9965),v=t(9008),b=t(2148),j=t(9669),g=t.n(j),w=t(6375),y=t(4247);function k(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){k(e,n,t[n])}))}return e}function O(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function C(e){var n=e.href,t=e.children,r=O(e,["href","children"]);return(0,a.jsx)(c.default,{href:n,children:(0,a.jsx)("a",N({},r,{children:t}))})}var S=t(1163);function E(e,n,t,r,s,a,c){try{var i=e[a](c),o=i.value}catch(w){return void t(w)}i.done?n(o):Promise.resolve(o).then(r,s)}function _(e){var n=e.children,t=e.title,r=(0,S.useRouter)(),j=(0,o.useSession)(),k=j.status,N=j.data,O=(0,i.useContext)(b.y),_=O.state,A=O.dispatch,D=_.darkMode,P=_.cart,L=(0,i.useState)(!1),Z=L[0],I=L[1],M=(0,i.useState)(!1),R=M[0],z=M[1],F=function(){I(!Z)};(0,i.useEffect)((function(){var e=function(){window.innerWidth>768&&Z&&I(!1)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[Z]),(0,i.useEffect)((function(){if(q(),window.matchMedia("(prefers-color-scheme: dark)").matches&&!d.Z.get("darkMode")){A({type:"DARK_MODE_ON"});var e=window.document.documentElement;e.classList.remove("light"),e.classList.add("dark")}if(D){A({type:"DARK_MODE_ON"});var n=window.document.documentElement;n.classList.remove("light"),n.classList.add("dark")}}),[D,A]);var K=(0,i.useState)([]),B=K[0],T=K[1],q=function(){var e,n=(e=s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g().get("/api/products/categories");case 3:n=e.sent.data,T(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),l.Am.error((0,w.b)(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function c(e){E(a,r,s,c,i,"next",e)}function i(e){E(a,r,s,c,i,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}(),U=(0,i.useState)(""),W=U[0],G=U[1],H=function(e){e.preventDefault(),r.push("/search?query=".concat(W))},J=function(){var e=!D;A({type:e?"DARK_MODE_ON":"DARK_MODE_OFF"}),d.Z.set("darkMode",e?"ON":"OFF");var n=window.document.documentElement;n.classList.remove(e?"light":"dark"),n.classList.add(e?"dark":"light")},Q=function(){d.Z.remove("cart"),A({type:"CART_RESET"}),(0,o.signOut)({callbackUrl:"/login"})},V=function(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("form",{onSubmit:H,className:"mx-auto mr-3 mt-1 flex w-full justify-center md:hidden",children:[(0,a.jsx)("input",{onChange:function(e){return G(e.target.value)},type:"search",className:"rounded-tr-none rounded-br-none p-1 text-sm",placeholder:"Search products"}),(0,a.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,a.jsx)(u.Z,{className:"h-5 w-5"})})]}),"loading"===k?"Loading":(null===N||void 0===N?void 0:N.user)?(0,a.jsxs)(y.v,{as:"div",className:"relative inline-block",children:[(0,a.jsx)(y.v.Button,{className:"text-blue-600",children:N.user.name}),(0,a.jsxs)(y.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-white shadow-lg dark:bg-black dark:shadow-gray-700",children:[(0,a.jsx)(y.v.Item,{children:(0,a.jsx)(C,{className:"dropdown-link",href:"/profile",children:"Profile"})}),(0,a.jsx)(y.v.Item,{children:(0,a.jsx)(C,{className:"dropdown-link",href:"/order-history",children:"Order History"})}),(0,a.jsx)(y.v.Item,{children:(0,a.jsx)(C,{className:"dropdown-link",href:"/admin/dashboard",children:"Admin Dashboard"})}),(0,a.jsx)(y.v.Item,{children:(0,a.jsx)("a",{className:"dropdown-link",href:"#",onClick:Q,children:"Logout"})})]})]}):(0,a.jsx)(c.default,{href:"/login",children:(0,a.jsx)("a",{className:"p-2",children:"Login"})}),(0,a.jsx)("div",{className:"mx-auto p-2",children:(0,a.jsx)(c.default,{href:"/cart",children:(0,a.jsxs)("a",{className:"flex items-center p-2",children:["Cart"," ",P.cartItems.length>0&&(0,a.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:P.cartItems.reduce((function(e,n){return e+n.quantity}),0)})]})})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"py-2 pr-2",children:D?(0,a.jsx)(h.Z,{onClick:J,className:"h-5 w-5 text-blue-500 "}):(0,a.jsx)(f.Z,{onClick:J,className:"h-5 w-5 text-blue-500 "})})})]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.default,{children:[(0,a.jsx)("title",{children:t||"Amazona"}),(0,a.jsx)("meta",{name:"description",content:"Ecommerce Website"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsx)(l.Ix,{position:"bottom-center",limit:1}),(0,a.jsxs)("div",{className:"flex min-h-screen flex-col justify-between bg-white text-black transition-all dark:bg-black dark:text-white",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("nav",{className:"relative flex h-12 items-center justify-between shadow-md dark:shadow-gray-700 ",role:"navigation",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"cursor-pointer px-4 ",onClick:function(){return z(!R)},children:(0,a.jsx)(m.Z,{className:"h-5 w-5 text-blue-500"})}),(0,a.jsx)(c.default,{href:"/",children:(0,a.jsx)("a",{className:"text-lg font-bold text-black dark:text-white",children:"amazona"})})]}),(0,a.jsxs)("form",{onSubmit:H,className:"mx-auto hidden w-full justify-center md:flex ",children:[(0,a.jsx)("input",{onChange:function(e){return G(e.target.value)},type:"search",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"Search products"}),(0,a.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,a.jsx)(u.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"cursor-pointer px-4 md:hidden",onClick:F,children:(0,a.jsx)(x.Z,{className:"h-5 w-5 text-blue-500"})}),(0,a.jsx)("div",{className:"hidden items-center md:flex",children:V()})]}),(0,a.jsx)("div",{className:Z?"grid grid-rows-2 items-center text-center":"hidden",onClick:F,children:V()}),(0,a.jsxs)("div",{className:"fixed top-0 left-0 z-40 h-full w-[20rem] bg-gray-300 p-10 duration-300  ease-in-out dark:bg-gray-800 ".concat(R?"translate-x-0":"translate-x-[-20rem]"),children:[(0,a.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,a.jsx)("h2",{children:"Shopping By Categories"}),(0,a.jsx)("button",{onClick:function(){return z(!R)},children:(0,a.jsx)(p.Z,{className:"h-5 w-5 "})})]}),(0,a.jsx)("ul",{children:B.map((function(e){return(0,a.jsx)("li",{onClick:function(){return z(!1)},children:(0,a.jsx)(c.default,{href:"/search?category=".concat(e),children:e})},e)}))})]})]}),(0,a.jsx)("div",{className:"container m-auto mt-4 px-4",children:n}),(0,a.jsx)("div",{className:"flex h-10 items-center justify-center shadow-inner dark:shadow-gray-700",children:(0,a.jsx)("p",{children:"Copyright \xa9 2022 Amazona"})})]})]})}},6375:function(e,n,t){t.d(n,{b:function(){return p}});var r=t(4051),s=t.n(r),a=t(6785),c=t.n(a),i=t(3454);function o(e,n,t,r,s,a,c){try{var i=e[a](c),o=i.value}catch(d){return void t(d)}i.done?n(o):Promise.resolve(o).then(r,s)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function c(e){o(a,r,s,c,i,"next",e)}function i(e){o(a,r,s,c,i,"throw",e)}c(void 0)}))}}var l={};function u(){return(u=d(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isConnected){e.next=3;break}return console.log("already connected"),e.abrupt("return");case 3:if(!(c().connections.length>0)){e.next=10;break}if(l.isConnected=c().connections[0].readyState,1!==l.isConnected){e.next=8;break}return console.log("use previous connection"),e.abrupt("return");case 8:return e.next=10,c().disconnect();case 10:return e.next=12,c().connect(i.env.MONGODB_URI,{});case 12:n=e.sent,console.log("new connection"),l.isConnected=n.connections[0].readyState;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=d(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isConnected){e.next=8;break}return e.next=4,c().disconnect();case 4:l.isConnected=!1,e.next=8;break;case 7:console.log("not disconnected");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f={connect:function(){return u.apply(this,arguments)},disconnect:function(){return h.apply(this,arguments)},convertDocToObj:function(e){return e._id=e._id.toString(),e.createdAt=e.createdAt.toString(),e.updatedAt=e.updatedAt.toString(),e}},m=f;function x(e,n,t,r,s,a,c){try{var i=e[a](c),o=i.value}catch(d){return void t(d)}i.done?n(o):Promise.resolve(o).then(r,s)}var p=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message};!function(){var e,n=(e=s().mark((function e(n,t,r,a){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.disconnect();case 2:r.status(500).send({message:n.toString()});case 3:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function c(e){x(a,r,s,c,i,"next",e)}function i(e){x(a,r,s,c,i,"throw",e)}c(void 0)}))})}()}}]);